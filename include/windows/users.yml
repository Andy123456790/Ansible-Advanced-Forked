---
- hosts: WinS2019
  become: false

- hosts: WinS2019
  gather_facts: false
  vars_files:
    - ../../group_vars/WindowsServer/vault.yml
    - ../../group_vars/WindowsServer/vars.yml
    - ../../csv/domain_users.yml
  tasks:
    - name: Voeg de gebruikers toe aan de domein.
      win_domain_user:
        name: "{{ item.key }}"
        firstname: "{{ item.value.firstname }}"
        surname: "{{ item.value.surname }}"
        password: "{{ item.value.password }}"
        password_expired: yes
        attributes:
          displayName: "{{ item.value.firstname }} {{ item.value.surname }}"
      loop: "{{ lookup('dict', users) }}"
